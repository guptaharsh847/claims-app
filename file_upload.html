<!DOCTYPE html>
<html>
<head>
    <title>Upload to Google Drive</title>
    <style>
        body { font-family: sans-serif; padding: 20px; }
        .container { max-width: 400px; margin: auto; border: 1px solid #ccc; padding: 20px; border-radius: 8px; }
        #status { margin-top: 15px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h3>Upload to My Drive</h3>
    <input type="file" id="fileInput">
    <br><br>
    <button onclick="uploadFile()">Upload File</button>
    <div id="status"></div>
</div>

<script>
    async function uploadFile() {
        const fileInput = document.getElementById('fileInput');
        const status = document.getElementById('status');
        
        if (fileInput.files.length === 0) {
            alert("Please select a file first!");
            return;
        }

        const file = fileInput.files[0];
        status.innerText = "Uploading... please wait.";

        // Convert file to Base64 so it can be sent via JSON
        const reader = new FileReader();
        reader.readAsDataURL(file);
        
        reader.onload = async function () {
            const base64Data = reader.result.split(',')[1];
            const payload = {
                base64: base64Data,
                type: file.type,
                name: file.name
            };

            // REPLACE THIS URL WITH YOUR GOOGLE APPS SCRIPT URL
            const scriptUrl = "https://script.google.com/macros/s/AKfycby-r5YV35GIOCiSHLFKti2ctTrndjOD9AHgc9vn0c6vhg6YOO5aPnhVQ7yPQi-NJS4mwQ/exec";

            try {
                const response = await fetch(scriptUrl, {
                    method: 'POST',
                    body: JSON.stringify(payload)
                });
                
                const result = await response.json();
                
                if (result.status === "success") {
                    status.style.color = "green";
                    status.innerText = "Success! File uploaded.";
                    console.log("File Link:", result.fileUrl);
                } else {
                    status.style.color = "red";
                    status.innerText = "Upload failed: " + result.message;
                }
            } catch (error) {
                status.style.color = "red";
                status.innerText = "Error connecting to script.";
                console.error(error);
            }
        };
    }
</script>

</body>
</html>